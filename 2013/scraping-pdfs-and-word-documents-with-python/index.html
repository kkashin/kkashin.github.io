<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> Scraping PDFs and Word Documents with Python | Konstantin Kashin </title> <meta name="description" content=" Konstantin Kashin is an Engineering Manager at Facebook, interested in causal inference, experimentation, and optimization. "> <meta name="keywords" content="data science, engineering, causal inference, A/B testing, experimentation, optimization"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Facebook / Open Graph --> <meta property="og:type" content="article"> <meta property="article:author" content="Konstantin Kashin"> <meta property="article:section" content="blog"> <meta property="article:tag" content=""> <meta property="article:published_time" content="2013-09-25 00:00:00 -0400"> <meta property="og:url" content="http://konstantinkashin.com/2013/scraping-pdfs-and-word-documents-with-python/"> <meta property="og:title" content=" Scraping PDFs and Word Documents with Python | Konstantin Kashin "> <meta property="og:image" content="http://konstantinkashin.com"> <meta property="og:description" content=" Konstantin Kashin is an Engineering Manager at Facebook, interested in causal inference, experimentation, and optimization. "> <meta property="og:site_name" content="Konstantin Kashin"> <meta property="og:locale" content="en_US"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content=""> <meta name="twitter:title" content=" Scraping PDFs and Word Documents with Python | Konstantin Kashin "> <meta name="twitter:description" content=" Konstantin Kashin is an Engineering Manager at Facebook, interested in causal inference, experimentation, and optimization. "> <meta name="twitter:image:src" content="http://konstantinkashin.com"> <!-- Social: Google+ / Schema.org --> <meta itemprop="name" content=" Scraping PDFs and Word Documents with Python | Konstantin Kashin "> <meta itemprop="description" content=" Konstantin Kashin is an Engineering Manager at Facebook, interested in causal inference, experimentation, and optimization. "> <meta itemprop="image" content="http://konstantinkashin.com"> <!-- rel prev and next --> <link rel="stylesheet" href="/assets/css/main.css"> <!-- Canonical link tag --> <link rel="canonical" href="http://konstantinkashin.com/2013/scraping-pdfs-and-word-documents-with-python/"> <link rel="alternate" type="application/rss+xml" title="Konstantin Kashin" href="http://konstantinkashin.com/feed.xml"> <script type="text/javascript"> var disqus_shortname = ''; var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-29054835-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> <!-- MathJax scripts --> <script type="text/x-mathjax-config"> MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']], displayMath: [['\\[','\\]'], ['$$','$$']]}}); </script> <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="/">Konstantin Kashin<span></span></a></h1> <ul class="navbar"> <li><a href="/about">about</a></li> <li><a href="/projects">projects</a></li> <li><a href="/data">data</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <h1 class="post-title" itemprop="name headline">Scraping PDFs and Word Documents with Python</h1> <p class="post-meta"><time datetime="2013-09-25T00:00:00-04:00" itemprop="datePublished">Sep 25, 2013</time></p> </header> <div class="post-content" itemprop="articleBody"> <p>This week I wanted to write a Python script that was able to extract text from both pdf files and Microsoft Word documents (both .doc and .docx formats). This actually proved to be rather difficult, particularly when it came to both Microsoft Word since there was no one utility that was able to handle both the old Word format and the more recent .docx one. This post is a summary of the utilities that I came across and what I finally used to complete this task.</p> <p><br /> First, with regards to pdf files, the main Python library for opening pdf files is <a href="http://www.unixuser.org/~euske/python/pdfminer/">PDFMiner</a>. There exist several additional libraries that essentially serve as wrappers to PDFMiner, including <a href="https://pypi.python.org/pypi/slate">Slate</a>. Slate is significantly simpler to use than PDFMiner, but this comes at the expense of very basic functionality. Even though I first tried to use Slate, it ended up not performing well for the pdfs I was working with. Specifically, it did not fully respect the original spacing between words, thereby cutting certain words into multiple fragments or concatenating others. I thus switched to PDFMiner because of its customizability. Using the pdf2txt.py command line utility, PDFMiner experienced a similar problem with word spacing. However, this turned out to be extremely easy to tune just using a word margin option passed to the pdf2txt.py utility. Specifically, I ran the following in the command line:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">pdf2txt.py -o foo.txt -W 0.5 foo.pdf</code></pre></figure> <p>When it comes to Word 2007 .docx files, the Python-based utility that worked well is the <a href="https://github.com/mikemaccana/python-docx">python-docx</a> library. It worked well in the command line as follows:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">./example-extracttext.py foo.docx foo.txt</code></pre></figure> <p>For older Word documents (for example Word 2003), the python-docx library does not work. I ended up using the C-based <a href="http://linux.die.net/man/1/antiword">antiword</a> utility. Originally a Linux-based utility, antiword (version 0.37) can be installed on Mac OS X as follows:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">brew update
brew install antiword</code></pre></figure> <p>From within Python, I was then easily able to convert a .doc document to text:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">&#39;antiword foo.doc &gt; foo.txt&#39;</span><span class="p">)</span></code></pre></figure> </div> <div class="post-nav"> <a rel="prev" class="prev" href="/2013/note-on-bivariate-regression/">&larr; Note on Bivariate Regression</a> <a rel="next" class="next" href="/2013/network-visualization-with-d3js/">Network Visualization with D3.js &rarr;</a> </div> </article> <footer class="site-footer"> <div class="container"> <small class="pull-left">&copy;2019 Konstantin Kashin. Made with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a>.</small> <small class="pull-right"> <ul class="contact-list"> <li> <a href="https://linkedin.com/in/konstantin-kashin-8939a492"><span class="icon"><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn icon</title><path fill="#828282" d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg> </span></a> </li> <li> <a href="https://github.com/kkashin"><span class="icon icon--github"><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub icon</title><path fill="#828282" d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg> </span></a> </li> <li> <a href="https://twitter.com/@kostyakashin"><span class="icon icon--twitter"><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Twitter icon</title><path fill="#828282" d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"/></svg> </span></a> </li> </ul></small> </div> <!-- Databits viz (needs to be in footer)--> <script type="text/javascript" src="http://databits.io/static/embed.js"></script> </footer> </main> </body> </html>
